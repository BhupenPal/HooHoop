<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="/assets/css/index.css" />
    <link rel="stylesheet" href="/assets/css/all.min.css" />
    <link rel="stylesheet" href="/assets/css/fonts.css" />
    <link rel="stylesheet" href="/assets/css/view360/demo.css" />
    <link rel="stylesheet" href="/assets/css/view360/pano.css" />
    <link rel="stylesheet" href="/assets/css/chatbot.css">
    <script src="/assets/scripts/script.js"></script>
    <title>HooHoop</title>
    <link
      rel="icon"
      href="/assets/images/favicon.ico"
      type="image/ico"
      sizes="16*16"
    />
  </head>
  <body class="c_p_body" onload="ImgChange('interiorMiddle.JPG')">
    <%-include('./Components/Header.ejs') %>

    <div class="cardet_page">
      <div class="th_sxty_info">
        <div class="th60_container">
          <div class="viewthsxty">
            <button class="interior-changer" onclick="intext('1'),showsl('1')">
              <i class="fad fa-steering-wheel"></i
              ><span class="tooltiptext">Interior</span>
            </button>
            <button class="exterior-changer" onclick="intext('2'),showsl('2')">
              <i class="fad fa-car"></i
              ><span class="tooltiptext">Exterior</span>
            </button>

            <select name="interiorSelect" id="INTSELECT" onchange="if (typeof(this.selectedIndex) != 'undefined') interiorImg(this.selectedIndex)">
            </select>

            <div class="panoviewer-container viewer">
              <div id="panoSet">
                <div class="panoviewer container" id="myPanoViewer"></div>
              </div>
            </div>

            <div class="iwdivide"></div>

            <div class="exterior_slider">
              <div
                class="cloudimage-360"
                data-folder="/assets/Uploads/<%= record.vinNum %>/exterior/"
                data-filename="Photo_{index}.jpg"
                data-amount="<%= photoArrayLength %>"
              ></div>
            </div>
          </div>
          <div class="car_name_price">
            <div class="c_name"><%= record.Make %></div>
            <div class="c_price">$<%= record.Price%></div>
          </div>
        </div>
        <div class="cardetails_tab">
          <h1>Specifications</h1>
          <div class="det_connect">
            <div class="ico_hold">
              <i class="fad fa-joystick"></i>
              <p>Transmission</p>
            </div>
            <div class="prop_hold"><%= record.Transmission %></div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fal fa-tachometer"></i>
              <span>KM</span>
            </div>
            <div class="prop_hold"><%= record.kMeters %></div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fad fa-gas-pump"></i>
              <span>Fuel Type</span>
            </div>
            <div class="prop_hold"><%= record.fuelType %></div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fas fa-loveseat"></i>
              <span>Seats</span>
            </div>
            <div class="prop_hold"><%= record.SeatNum %></div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fad fa-cogs"></i>
              <span>Engine</span>
            </div>
            <div class="prop_hold"><%= record.engineSize %> cc</div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fad fa-car-alt"></i>
              <span>Body style</span>
            </div>
            <div class="prop_hold"><%= record.BodyType %></div>
          </div>

          <div class="det_connect">
            <div class="ico_hold">
              <i class="fad fa-paint-brush-alt"></i>
              <span>Color</span>
            </div>
            <div class="prop_hold"><%= record.Colour %></div>
          </div>
        </div>
      </div>
      <div class="panel-contain">
        <div class="nav_with_panel_tabs">
          <div class="panel_tabs">
            <div class="tabs active-tab" onclick="tabselect(0)">
              Book a Test Drive
            </div>
            <div class="tabs" onclick="tabselect(1)">Check Availability</div>
            <div class="tabs" onclick="tabselect(2)">Shipping Quote</div>
          </div>
          <div class="panel_body">
            <div class="p-body">
              <h2 class="p_body_headlines">Book a Test Drive</h2>
              <form method="POST">
                <label for="ft_name">First Name</label>
                <input type="text" id="ft_name" name="ft_name" required />

                <label for="lt_name">Last Name</label>
                <input type="text" id="lt_name" name="lt_name" required />

                <label for="bt_email">Email Address</label>
                <input type="email" id="bt_email" name="bt_email" required />

                <label for="pt_phone">Phone Number</label>
                <input type="number" id="pt_phone" name="pt_phone" required />

                <button
                  class="submit-button"
                  type="submit"
                  formaction="http://localhost:8080/buy-car/<%= record._id %>/book-test-drive"
                >
                  Submit
                </button>
              </form>
            </div>
            <div class="p-body vanish">
              <h2 class="p_body_headlines">Check Availability</h2>
              <h3 class="p_body_headlines">
                Hi, I am interested. Can you tell me more?
              </h3>
              <form method="POST">
                <label for="ck_name">Name</label>
                <input type="text" id="ck_name" name="ck_name" required />

                <label for="ck_email">Email Address</label>
                <input type="email" id="ck_email" name="ck_email" required />

                <label for="ck_phone">Phone Number</label>
                <input type="number" id="ck_phone" name="ck_phone" required />

                <button
                  class="submit-button"
                  type="submit"
                  formaction="http://localhost:8080/buy-car/<%= record._id %>/check-availbility"
                >
                  Submit
                </button>
              </form>
            </div>
            <div class="p-body vanish">
              <h2 class="p_body_headlines">Request a transport Quote</h2>
              <form method="POST">
                <span>Contact Details</span>
                <label for="sq_name">Name</label>
                <input type="text" id="sq_name" name="sq_name" required />

                <label for="sq_email">Email Address</label>
                <input type="email" id="sq_email" name="sq_email" required />

                <label for="sq_phone">Phone Number</label>
                <input type="number" id="sq_phone" name="sq_phone" required />

                <span>Transport Details</span>
                <label for="wh_move_from"
                  >Where will the vehicle be move from</label
                >
                <input type="text" id="wh_move_from" name="wh_move_from" required />

                <label for="wh_move_to"
                  >Where will the vehicle be move to</label
                >
                <input type="text" id="wh_move_to" name="wh_move_to" required />

                <label for="wh_date"
                  >What is your prefered transport date</label
                >
                <input type="date" id="wh_date" name="wh_date" required />

                <label for="wh_question"
                  >Do you have any other notes OR question (optional)</label
                >
                <textarea
                  name="wh_question"
                  id="wh_question"
                  cols="30"
                  rows="5"
                ></textarea>

                <button
                  class="submit-button"
                  type="submit"
                  formaction="http://localhost:8080/buy-car/<%= record._id %>/shipping-quote"
                >
                  Submit
                </button>
              </form>
            </div>
          </div>
        </div>
        <div class="seller-details">
          <p>Seller:<%= record.DealerName %></p>
          <p>Contact Number: <%= record.DealerNum %> </p>
          <p>Contact Email: <%= record.DealerEmail %></p>
        </div>
      </div>
      <%-include('./Components/chatbot.ejs') %>
    </div>
    <%-include('./Components/Footer.ejs') %>
    <input type="text" id="minor" style="display: block;" value="<%= record.minPrice %>">
    <input type="text" id="major" style="display: block;" value="<%= record.Price %>">
    <script src="/assets/scripts/view360-interior/jquery.js"></script>
    <script src="/assets/scripts/view360-interior/gyro.js"></script>
    <script src="/assets/scripts/view360-interior/pano.js"></script>
    <script src="/assets/scripts/view360-interior/pieview.js"></script>
    <script src="/assets/scripts/view360-interior/screenfull.js"></script>
    <script src="/assets/scripts/view360-interior/view360.js"></script>
    <script src="/assets//scripts/view360-exterior/min.js"></script>
    <script src="/assets/scripts/chatbot.js"></script>
    <script src="/assets/scripts/ajax/interiorCheck.js"></script>
    <script>
      const front = `/assets/Uploads/<%= record.vinNum %>/interior/interiorFront.JPG`;
const middle = `/assets/Uploads/<%= record.vinNum %>/interior/interiorMiddle.JPG`;
const rear = `/assets/Uploads/<%= record.vinNum %>/interior/interiorRear.JPG`;
const select = document.getElementById("INTSELECT");

function FileExist(urlToFile) {
    var xhr = new XMLHttpRequest();
    xhr.open('HEAD', urlToFile, false);
    xhr.send();
    
    if (xhr.status == "404") {
            return false;
    } else {
        return true;
    }
}

if (FileExist(front)){
    var opt = document.createElement('option');
    opt.value = "FRONT";
    opt.innerHTML = "Front";
    select.appendChild(opt);
}

if(FileExist(middle)){
    var opt = document.createElement('option');
    opt.value = "MIDDLE";
    opt.innerHTML = "Middle";
    select.appendChild(opt);
}

if(FileExist(rear)){
    var opt = document.createElement('option');
    opt.value = "REAR";
    opt.innerHTML = "Rear";
    opt.onchange
    select.appendChild(opt);
}
    </script>
    <script>
      function interiorImg(){
            let x = document.getElementById("INTSELECT").value
            console.log(x)
            if(x=="FRONT"){
              imgchange = "interiorFront.JPG"
            }
            if(x=="MIDDLE"){
              imgchange = "interiorMiddle.JPG"
            }
            if(x=="REAR"){
              imgchange = "interiorRear.JPG"
            }
            ImgChange(imgchange)
            console.log(imgchange)
          }

      function ImgChange(imgname){
        let myPan = document.getElementsByClassName("panoviewer-container")[0];
        
        document.getElementsByClassName("viewthsxty")[0].removeChild(myPan)
        console.log(imgname)

        let panoviewerHTML = '\
              <div class="panoviewer-container viewer" style="z-index:30">\
                <div id="panoSet">\
                  <div class="panoviewer container" id="myPanoViewer"></div>\
                </div>\
              </div>';

        let whereinsert = document.getElementById("INTSELECT")

        whereinsert.insertAdjacentHTML("afterend",panoviewerHTML)

        var PanoViewer = eg.view360.PanoViewer;
        var container = document.getElementById("myPanoViewer");
        let panoViewer = new PanoViewer(container, {
          image: `/assets/Uploads/<%= record.vinNum %>/interior/${imgname}`,
          projectionType: "equirectangular"
        });

        var panoviewerSet = document.getElementById("panoSet");
        PanoControls.init(panoviewerSet, panoViewer, {
          enableGyroOption: true,
          enableTouchOption: true
        });
        PanoControls.showLoading();
      }
    </script>
  </body>
</html>
